<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Horloge personnalisable</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      user-select: none;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      position: relative;
    }

    #background {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: url('https://pbs.twimg.com/media/Gg8dWSDXkAEbKjI?format=jpg&name=4096x4096') center/cover no-repeat;
      z-index: 0;
      cursor: move;
      transition: background 0.3s ease;
    }

    #clock {
      text-align: center;
      font-weight: 900;
      z-index: 1;
      opacity: 1;
      mix-blend-mode: difference;
      color: white;
      user-select: none;
      position: relative;
      transition: filter 0.3s ease, color 0.3s ease, background 0.3s ease;
    }

    #hours { margin: 0; line-height: 1; }
    #minutes { line-height: 1; font-weight: 600; }

    /* Controls */
    #controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 1em;
      border-radius: 10px;
      display: none;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 0.9em;
      z-index: 10;
      width: 550px;
      justify-content: center;
    }

    .slider-group, .select-group {
      display: flex;
      align-items: center;
      gap: 0.5em;
      flex: 1 1 150px;
    }
    .slider-group label, .select-group label { width: 90px; }
    .slider-group input[type="range"], .slider-group input[type="text"], .select-group select { flex: 1; }

    .gradient-text {
      background: linear-gradient(120deg,
        #ff0040,#ff7b00,#fffb00,#00ff9d,#00c3ff,#7b00ff,#ff00c8
      );
      background-size: 400% 400%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: brightness(1.2) contrast(1.2);
      mix-blend-mode: normal;
    }

    .animated-gradient { animation: gradientFlow linear infinite; }
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    #toggleEdit {
      position: fixed;
      top: 15px;
      right: 15px;
      background: rgba(0,0,0,0.7);
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      z-index: 11;
    }
  </style>
</head>
<body>

<div id="background"></div>

<div id="clock">
  <div id="hours">--</div>
  <div id="minutes">--</div>
</div>

<div id="controls">
  <div class="slider-group" id="brightnessGroup">
    <label for="brightness">Luminosité</label>
    <input type="range" id="brightness" min="10" max="150" />
  </div>
  <div class="slider-group" id="saturationGroup">
    <label for="saturation">Saturation</label>
    <input type="range" id="saturation" min="0" max="200" />
  </div>
  <div class="slider-group">
    <label for="contrast">Contraste</label>
    <input type="range" id="contrast" min="50" max="200" />
  </div>
  <div class="slider-group">
    <label for="hoursWeight">Gras heures</label>
    <input type="range" id="hoursWeight" min="100" max="900" step="10" />
  </div>
  <div class="slider-group">
    <label for="minutesWeight">Gras minutes</label>
    <input type="range" id="minutesWeight" min="100" max="900" step="10" />
  </div>
  <div class="slider-group">
    <label for="hoursSize">Taille Heures</label>
    <input type="range" id="hoursSize" min="20" max="400" value="140">
  </div>
  <div class="slider-group">
    <label for="minutesSize">Taille Minutes</label>
    <input type="range" id="minutesSize" min="20" max="400" value="100">
  </div>
  <div class="select-group">
    <label for="colorMode">Couleur</label>
    <select id="colorMode">
      <option value="negative">Négatif</option>
      <option value="gradient">Gradient</option>
    </select>
  </div>
  <div class="slider-group" id="hueGroup">
    <label for="hue">Teinte</label>
    <input type="range" id="hue" min="0" max="360" />
  </div>
  <div class="slider-group">
    <label for="animationIntensity">Intensité</label>
    <input type="range" id="animationIntensity" min="0" max="100" />
  </div>
  <div class="slider-group">
    <label for="animationSpeed">Vitesse</label>
    <input type="range" id="animationSpeed" min="0" max="100" />
  </div>
  <div class="slider-group">
    <label for="backgroundURL">Fond</label>
    <input type="text" id="backgroundURL" placeholder="Coller le lien de l'image ici" />
  </div>
  <div class="slider-group">
    <label for="bgSize">Fond (%)</label>
    <input type="range" id="bgSize" min="50" max="200" />
  </div>
  <div class="slider-group">
    <label for="bgX">X (%)</label>
    <input type="range" id="bgX" min="0" max="100" />
  </div>
  <div class="slider-group">
    <label for="bgY">Y (%)</label>
    <input type="range" id="bgY" min="0" max="100" />
  </div>
</div>

<button id="toggleEdit">Afficher édition</button>

<script>
const clock = document.getElementById('clock');
const background = document.getElementById('background');
const hoursEl = document.getElementById('hours');
const minutesEl = document.getElementById('minutes');
const controls = document.getElementById('controls');
const toggleEditBtn = document.getElementById('toggleEdit');

const inputs = {
  brightness: document.getElementById('brightness'),
  saturation: document.getElementById('saturation'),
  contrast: document.getElementById('contrast'),
  hoursWeight: document.getElementById('hoursWeight'),
  minutesWeight: document.getElementById('minutesWeight'),
  hoursSize: document.getElementById('hoursSize'),
  minutesSize: document.getElementById('minutesSize'),
  colorMode: document.getElementById('colorMode'),
  hue: document.getElementById('hue'),
  animationIntensity: document.getElementById('animationIntensity'),
  animationSpeed: document.getElementById('animationSpeed'),
  backgroundURL: document.getElementById('backgroundURL'),
  bgSize: document.getElementById('bgSize'),
  bgX: document.getElementById('bgX'),
  bgY: document.getElementById('bgY')
};

const groups = {
  brightnessGroup: document.getElementById('brightnessGroup'),
  saturationGroup: document.getElementById('saturationGroup'),
  hueGroup: document.getElementById('hueGroup')
};

// Horloge
function updateClock() {
  const now = new Date();
  hoursEl.textContent = String(now.getHours()).padStart(2,'0');
  minutesEl.textContent = String(now.getMinutes()).padStart(2,'0');
}
setInterval(updateClock, 1000);
updateClock();

// Charger les options sauvegardées
function loadOptions() {
  Object.keys(inputs).forEach(key => {
    if(localStorage.getItem(key) !== null) {
      inputs[key].value = localStorage.getItem(key);
    }
  });
  updateStyles();
}

// Sauvegarder options
function saveOptions() {
  Object.keys(inputs).forEach(key => {
    localStorage.setItem(key, inputs[key].value);
  });
}

// Appliquer styles
function updateStyles() {
  hoursEl.style.fontSize = inputs.hoursSize.value + "px";
  minutesEl.style.fontSize = inputs.minutesSize.value + "px";

  hoursEl.style.fontWeight = inputs.hoursWeight.value;
  minutesEl.style.fontWeight = inputs.minutesWeight.value;

  // Ajustement dynamique de l'espacement minutes
  const hourSize = parseInt(inputs.hoursSize.value);
  minutesEl.style.marginTop = `-${Math.floor(hourSize * 0.15)}px`;

  const contrast = inputs.contrast.value;
  const mode = inputs.colorMode.value;

  if(mode === 'negative') {
    groups.brightnessGroup.style.display = 'flex';
    groups.saturationGroup.style.display = 'none';
    groups.hueGroup.style.display = 'none';
    clock.style.mixBlendMode = 'difference';
    clock.style.color = 'white';
    clock.classList.remove('gradient-text','animated-gradient');
    clock.style.filter = `brightness(${inputs.brightness.value}%) contrast(${contrast}%) saturate(100%)`;
  } else {
    groups.brightnessGroup.style.display = 'none';
    groups.saturationGroup.style.display = 'flex';
    groups.hueGroup.style.display = 'flex';
    clock.classList.add('gradient-text');
    const intensity = inputs.animationIntensity.value / 100;
    const minSize = 400;
    const maxSize = 600;
    clock.style.backgroundSize = `${minSize + intensity*(maxSize-minSize)}% 400%`;
    const speed = 25 - (inputs.animationSpeed.value/100)*24;
    clock.style.animationDuration = `${speed}s`;
    clock.classList.add('animated-gradient');
    clock.style.filter = `contrast(${contrast}%) saturate(${inputs.saturation.value}%) hue-rotate(${inputs.hue.value}deg)`;
  }

  background.style.background = `url('${inputs.backgroundURL.value}') ${inputs.bgX.value}% ${inputs.bgY.value}% / ${inputs.bgSize.value}% auto no-repeat`;

  saveOptions();
}

// Inputs
Object.values(inputs).forEach(el => el.addEventListener('input', updateStyles));

// Toggle édition
toggleEditBtn.addEventListener('click', () => {
  if(controls.style.display === 'none') {
    controls.style.display = 'flex';
    toggleEditBtn.textContent = 'Masquer édition';
  } else {
    controls.style.display = 'none';
    toggleEditBtn.textContent = 'Afficher édition';
  }
});

// Glisser fond
let isDragging = false, startX, startY;
background.addEventListener('mousedown', e => {
  isDragging = true;
  startX = e.clientX;
  startY = e.clientY;
});
document.addEventListener('mouseup', () => { isDragging = false; });
document.addEventListener('mousemove', e => {
  if(!isDragging) return;
  const dx = e.clientX - startX;
  const dy = e.clientY - startY;
  let x = Math.min(100, Math.max(0, parseFloat(inputs.bgX.value) + dx / window.innerWidth * 100));
  let y = Math.min(100, Math.max(0, parseFloat(inputs.bgY.value) + dy / window.innerHeight * 100));
  inputs.bgX.value = x;
  inputs.bgY.value = y;
  updateStyles();
  startX = e.clientX;
  startY = e.clientY;
});

// Initialisation
loadOptions();
</script>
</body>
</html>
